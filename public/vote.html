<html>

<head>
    <meta charset="utf-8">
    <title>INT Chain</title>
    <link rel="stylesheet" href="./css/index.css" />
    <link rel="icon" href="./images/intlogo.png" type="image/x-icon" />
    <script src="./js/plugins/jquery/jquery-3.3.1.min.js"></script>
    <link href="./js/plugins/layer/skin/default/layer.css" rel="stylesheet">
    <script src="./js/plugins/layer/layer.js"></script>
    <script src="./js/page/modal.js"></script>

    <script type="text/javascript" src="./js/page/language.js"></script>
    <script type="text/javascript" src="./js/page/babelfill.js"></script>
    <script type="text/javascript" src="./js/plugins/angular/angular.js"></script>
    <script type="text/javascript" src="./js/plugins/angular/angular-sanitize.min.js"></script>
    <script type="text/javascript" src="./js/plugins/angular/angular-animate.min.js"></script>
    <script type="text/javascript" src="./js/plugins/angular/angular-route.js"></script>
    <script type="text/javascript" src="./js/plugins/angular/angular-file-upload.min.js"></script>
    <script type="text/javascript" src="./js/plugins/moment.js"></script>
    <script type="text/javascript" src="./js/app/ngapp.js"></script>
    <script type="text/javascript" src="./js/app/directives/uploaddirectives.js"></script>
    <script type="text/javascript" src="./js/page/common.js"></script>
    <script type="text/javascript" src="./js/page/vote.js"></script>
    <!-- <script type="text/javascript" src="./js/page/int.js"></script> -->
    <script type="text/javascript" src="./js/page/wal.js"></script>



    <style>
        .main {
            padding: 50px 0 0 165px;
        }
        
        .out {
            height: 14px;
            width: 14px;
            border: 1px solid #cd222d;
            border-radius: 8px;
            display: inline-block;
            cursor: pointer;
        }
        
        .in {
            height: 8px;
            width: 8px;
            background-color: #cd222d;
            border-radius: 5px;
            margin: 2px;
            display: inline-block;
        }
        
        .inac {
            height: 14px;
            width: 14px;
            border: 1px solid rgba(204, 204, 204, 1);
            border-radius: 8px;
            display: inline-block;
            cursor: pointer;
        }
        
        .ch-item {
            display: inline;
        }
        
        .ch-item span {
            margin-left: 8px;
        }
        
        .pri {
            margin-left: 75px;
        }
        
        .ch {
            margin-top: 18px;
            color: rgba(102, 102, 102, 1);
            font-size: 16px;
            font-family: PingFangSC-Medium;
        }
        
        .se {
            margin-top: 36px;
            color: rgba(102, 102, 102, 1);
            font-size: 16px;
            font-weight: bold;
            font-family: PingFangSC-Medium;
        }
        
        .warn {
            margin-top: 20px;
            width: 852px;
            color: rgba(215, 49, 111, 1);
            font-size: 12px;
            font-family: PingFangSC-Regular;
        }
        
        .ch-file {
            margin-top: 16px;
            width: 240px;
        }
        
        .is .lt1 {
            width: 412px;
            height: 50px;
            border-radius: 4px;
            border: 1px solid rgba(204, 204, 204, 1);
            line-height: 50px;
            cursor: pointer;
            color: rgba(102, 102, 102, 1);
            font-family: PingFangSC-Medium;
            text-align: center;
            font-size: 14px;
        }
        
        .middle {
            margin-top: 36px;
            color: rgba(153, 153, 153, 1);
            font-size: 12px;
            text-align: left;
            font-family: PingFangSC-Regular;
        }
        
        .in-box {
            display: inline-block;
            width: 410px;
            height: 46px;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 1);
            border: 1px solid rgba(204, 204, 204, 1);
        }
        
        .in-box img {
            cursor: pointer;
        }
        
        input {
            margin-left: 24px;
            width: 85%;
            height: 98%;
            border: 0px;
            outline: none
        }
        
        input::-webkit-input-placeholder {
            color: rgba(153, 153, 153, 1);
            font-family: PingFangSC-Regular;
        }
        
        .btn-dis {
            font-family: PingFangSC-Regular;
            margin-top: 36px;
            width: 240px;
            height: 50px;
            border-radius: 4px;
            background-color: rgba(204, 204, 204, 1);
            text-align: center;
            line-height: 50px;
            font-size: 16px;
            color: rgba(255, 255, 255, 1);
            cursor: not-allowed;
        }
        
        .btn-unlock {
            margin-top: 36px;
            width: 240px;
            height: 50px;
            border-radius: 4px;
            background-color: #cd222d;
            text-align: center;
            line-height: 50px;
            font-size: 16px;
            color: rgba(255, 255, 255, 1);
            cursor: pointer;
        }
        
        .msg {
            margin-top: 25px;
            width: 300px;
            height: 32px;
            opacity: 0.8;
            border-radius: 4px;
            background-color: rgba(215, 49, 111, 1);
            line-height: 32px;
            padding-left: 13px;
            color: rgba(255, 255, 255, 1);
            font-size: 12px;
        }
        
        .item-box {
            display: inline-block;
            color: rgba(51, 51, 51, 1);
            font-size: 16px;
            font-family: PingFangSC-Medium;
            margin-top: 24px;
            font-weight: bold;
        }
        
        .node-item {
            width: 880px;
            height: 60px;
            border-radius: 4px;
            background-color: rgba(244, 248, 255, 1);
            line-height: 28px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 16px;
        }
        
        .no-ch {
            width: 15px;
            height: 15px;
            border: 1px solid rgba(204, 204, 204, 1);
            border-radius: 8px;
            margin-top: 20px;
            margin-left: 24px;
            display: inline-block;
        }
        
        .node-item .icon {
            display: inline-block;
            vertical-align: top;
            margin-top: 20px;
            margin-left: 24px;
        }
        
        .node-item .node {
            display: inline-block;
            vertical-align: top;
            margin-left: 24px;
            border-right: 1px solid rgba(221, 233, 255, 1);
            width: 430px;
        }
        
        .node-item .vote {
            display: inline-block;
            vertical-align: top;
            margin-left: 10px;
            line-height: 62px;
        }
        
        .node-box {
            height: 500px;
            overflow-y: scroll;
            width: 880px;
            margin-top: 36px;
        }
        
        .voteTab {
            margin-top: 30px;
        }
        
        .voted-reward a:hover {
            color: #cd222d
        }
        
        .nodeName {
            line-height: 20px
        }
    </style>
    <script src="https://vuejs.org/js/vue.min.js"></script>
    <!-- import stylesheet -->
    <link rel="stylesheet" href="https://unpkg.com/iview/dist/styles/iview.css">
    <!-- import iView -->
    <script src="https://unpkg.com/iview/dist/iview.min.js"></script>
    <script src="https://unpkg.com/iview/dist/locale/en-US.js"></script>
    <script src="https://unpkg.com/iview/dist/locale/zh-CN.js"></script>

    <body ng-app="myApp">
        <div class="container" ng-controller="voteController">
            <div ng-show="!step" style="width: 100%;height: 100%"></div>
            <div class="header-box">
                <div class="header-con">
                    <div class="logo">
                        <img src="./images/intlogo.png" width="72px" height="72px">
                    </div>
                    <div class="tabbar-box">
                        <div class="tab-item ">
                            <span>
                                <a href="./index.html?lan={{lan}}">{{doc.newWallet}}</a>
                      </span>

                        </div>
                        <div class="tab-item">
                            <span>
                                <a href="./walletInfo.html?lan={{lan}}"> {{doc.viewWllet}}</a>
                      </span>

                        </div>
                        <div class="tab-item">
                            <span>
                                <a href="./mapping.html?lan={{lan}}">{{doc.mapping}}</a>                       
                       </span>

                        </div>
                        <div class="tab-item">
                            <span>
                       <a href="./send.html?lan={{lan}}"> {{doc.sendInt}}</a>
                      </span>

                        </div>
                        <div id="vote" ng-mouseenter="voteTabView = true" ng-mouseleave="voteTabView = false" class="tab-item active">
                            <span>
                                    {{doc.vote}}
                                    <img  src="./images/voteac.jpg" alt="" height="11px">
                            </span>
                            <div class="b-line" style="margin-left:5px"></div>
                            <div class="voteTab" ng-show="voteTabView">
                                <div class="voteTab-item">
                                    <a href="javascript:;" ng-click="action='Mortgage'">
                                            {{doc.mortgage}}
                                </a>
                                </div>
                                <div class="voteTab-item">
                                    <a href="javascript:;" ng-click="action='Vote'">
                                            {{doc.vote}}
                                </a>
                                </div>
                                <div class="voteTab-item">
                                    <a href="javascript:;" ng-click="action='Unmortgage'">
                                            {{doc.unmortgage}} 
                                </a>
                                </div>
                                <div class="voteTab-item">
                                    <a href="javascript:;" ng-click="action='Referendum'">
                                                {{doc.referendum}} 
                                    </a>
                                </div>
                            </div>
                        </div>


                        <div id="token" ng-mouseenter="tokenView = true" ng-mouseleave="tokenView = false" class="tab-item">
                            <span>
                                            <a href="javascript:;" >Token </a>
                                             <img  src="./images/voteunac.png" alt="">
                                    </span>
                            <div></div>
                            <div class="voteTab" ng-show="tokenView">
                                <div class="voteTab-item">
                                    <a href="./token.html?action=create&lan={{lan}}">
                                                {{doc.create}} 
                                            </a>
                                </div>
                                <div class="voteTab-item">
                                    <a href="./token.html?action=transfer&lan={{lan}}">
                                                {{doc.transfer}} 
                                            </a>
                                </div>
                            </div>
                        </div>


                        <div class="tab-item">
                            <span>
                                    <a href="./help.html?lan={{lan}}">{{doc.help}}</a>                      
                                </span>
                        </div>

                        <div id="lan" ng-mouseenter="lanView = true" ng-mouseleave="lanView = false" class="tab-item">
                            <span>
                                        <a href="javascript:;" >{{doc.language}} </a>
                                         <img  src="./images/voteunac.png" alt="">
                                </span>
                            <div></div>
                            <div class="voteTab" ng-show="lanView">
                                <div class="voteTab-item" ng-click="changelan('en')">
                                    <a href="javascript:;">
                                            English
                                        </a>
                                </div>
                                <div class="voteTab-item" ng-click="changelan('zh')">
                                    <a href="javascript:;">
                                            中文
                                        </a>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
            <div class="content">
                <div class="con-top">
                    <img style="margin-bottom:-4px" src="./images/vote.png" alt=""><span>{{title}}</span>
                </div>
                <div class="main">
                    <div ng-show="step==1" style="margin-left:113px">
                        <div class="title">{{doc.access}}</div>
                        <div class="ch">
                            <div class="ch-item">
                                <div ng-show="ch=='keyStore'" class="out">
                                    <div class="in"></div>
                                </div>
                                <div ng-show="ch=='privateKey'" ng-click="ch='keyStore';unlockDisabled = true" class="inac"></div>
                                <span>Keystore</span>
                            </div>
                            <div class="ch-item pri">
                                <div ng-show="ch=='privateKey'" class="out">
                                    <div class="in"></div>
                                </div>
                                <div ng-show="ch=='keyStore'" ng-click="ch='privateKey';unlockDisabled = true" class="inac"></div>
                                <span>{{doc.privateKey}}</span>
                            </div>
                        </div>
                        <div ng-show="ch=='keyStore'">
                            <div class="se">{{doc.selectStore}}</div>
                            <!-- <div class="warn">
                                <img src="./images/warn.png" width="12px">
                                <span>this is not a recommended  way to access your wallet. Entering your private key on
                            a website dangerous. If our website is compromised or you accidentally visit a
                            different website, your funds will be stolen</span>
                            </div> -->
                            <div file-uploader password="password" doc="doc" file="file" class="ch-file">
                            </div>
                            <div class="btn-dis" ng-show="unlockDisabled">{{doc.unlock}}</div>
                            <div class="btn-unlock" ng-click="unlock()" ng-show="!unlockDisabled">{{doc.unlock}}</div>
                            <div class="msg" ng-show="keyStoreUnlockFail">
                                <img src="./images/msg.png" width="14px" style="float:left;padding-top:9px">
                                <span style="padding-left: 14.5px">{{doc.passError}}</span>
                                <img ng-click="keyStoreUnlockFail = false" style="padding:10px;float:right;cursor: pointer" src="./images/close.png" width="13px">
                            </div>
                        </div>
                        <div ng-show="ch=='privateKey'">
                            <div class="se">{{doc.ePri}}</div>
                            <!-- <div class="warn">
                                <img src="./images/warn.png" width="12px">
                                <span>this is not a recommended  way to access your wallet. Entering your private key on
                            a website dangerous. If our website is compromised or you accidentally visit a
                            different website, your funds will be stolen</span>
                            </div> -->

                            <div style="height: 16px"></div>
                            <div class="in-box">
                                <input ng-keyup="enterUnlock($event)" ng-show="!privateKeyView" type="password" ng-model="privateKey" ng-change="unlockDisabled = false " placeholder="{{doc.enPriKey}}">
                                <input ng-keyup="enterUnlock($event)" ng-show="privateKeyView" type="text" ng-model="privateKey" placeholder="{{doc.enPriKey}}">
                                <img ng-click="privateKeyView=!privateKeyView" ng-show="privateKeyView" src="./images/eyeopen.png">
                                <img ng-click="privateKeyView=!privateKeyView" ng-show="!privateKeyView" src="./images/eyeclose.png">
                            </div>
                            <div class="btn-dis" ng-show="unlockDisabled">{{doc.unlock}}</div>
                            <div class="btn-unlock" ng-click="unlock()" ng-show="!unlockDisabled">{{doc.unlock}}</div>
                            <div class="msg" ng-show="privateKeyUnlockFail">
                                <img src="./images/msg.png" width="14px" style="float:left;padding-top:9px">
                                <span style="padding-left: 14.5px">{{doc.validPrivateKey}}</span>
                                <img ng-click="keyStoreUnlockFail = false" style="padding:10px;float:right;cursor: pointer" src="./images/close.png" width="13px">
                            </div>
                        </div>
                        <div style="margin-top:10px;font-family: PingFangSC-Regular;font-size: 14px;   color: rgba(102, 102, 102, 1);">
                            {{doc.callUs}}<br> {{doc.email}}
                        </div>
                    </div>
                    <div ng-show="action=='Vote'&&step==2">
                        <div class="item-box">
                            <div class="lable">{{doc.votes}}</div>
                            <div class="in-box">
                                <input ng-keyup="enterVote($event)" type="text" readonly ng-model="vote">
                            </div>
                        </div>
                        <div class="item-box" style="margin-left: 50px">
                            <div class="lable">{{doc.balance}}</div>
                            <div class="in-box">
                                <input ng-keyup="enterVote($event)" type="text" readonly ng-model="balance">
                            </div>
                        </div>
                        <div class="item-box">
                            <div class="lable">{{doc.search}}</div>
                            <div class="in-box">
                                <input ng-keyup="enterVote($event)" type="text" ng-model="searchStr">
                            </div>
                        </div>
                        <div class="item-box" style="margin-left: 50px">
                            <div class="voted-reward" style="margin-top: 48px" ng-click="showRecord()">
                                <a style="text-decoration:underline" href=" javascript:; ">{{doc.votedAndRecord}}</a>
                            </div>
                        </div>
                        <div class="node-box ">
                            <div class="node-item " ng-repeat="n in nodes " ng-class="{ 'nodeName':!n.teamName}" ng-click="chooseNodes($index) " ng-if="n.node.indexOf(searchStr)>=0||n.teamName.indexOf(searchStr)>=0">
                                <img ng-show="n.ch" class="icon" src="./images/choose.png" alt="">
                                <div ng-show="!n.ch" class="no-ch"></div>
                                <div class="node">
                                    <span ng-show="!n.webUrl" style="font-style: italic;color: #8d8d8d">{{n.teamName}} </span>
                                    <a style="text-decoration:underline;color: rgba(60, 49, 215, 1);font-style: italic;" ng-show="n.webUrl" href="{{n.webUrl}}" target="_blank">{{n.teamName}}</a>
                                    <br> {{n.node}}
                                </div>
                                <div class="vote"><span style="color: rgba(60, 49, 215, 1)">{{n.num}}</span> {{doc.stakes}}</div>
                            </div>
                        </div>
                        <div class="item-box">
                            <div class="lable">Gas Limit</div>
                            <div class="in-box">
                                <input ng-keyup="enterVote($event)" type="text" placeholder="Gas Limit" ng-model="voteLimit">
                            </div>
                        </div>
                        <div class="item-box" style="margin-left: 50px">
                            <div class="lable">Gas Price</div>
                            <div class="in-box">
                                <input ng-keyup="enterVote($event)" type="text" placeholder="Gas Price" ng-model="votePrice">
                            </div>
                        </div>
                        <div>
                            <span style="display:inline-block;margin-left: 570px;width: 40px">{{chNum}}/20</span>
                            <div style="display: inline-block;margin-left: 25px">
                                <div class="btn-dis" style="margin-top: 48px" ng-show="!votePass">{{doc.vote}}</div>
                                <div class="btn-unlock" style="margin-top: 48px" ng-click="Vote()" ng-show="votePass">
                                    {{doc.vote}}</div>
                            </div>
                        </div>
                        <div style="margin-top:10px;font-family: PingFangSC-Regular;font-size: 14px;   color: rgba(102, 102, 102, 1);">
                            {{doc.callUs}}<br> {{doc.email}}
                        </div>
                    </div>
                    <div ng-show="action=='Mortgage' && step == 2">
                        <div class="item-box">
                            <div class="lable">{{doc.votes}}</div>
                            <div class="in-box">
                                <input ng-keyup="enterMorgage($event)" type="text" readonly ng-model="vote">
                            </div>
                        </div>
                        <div class="item-box" style="margin-left: 50px">
                            <div class="lable">{{doc.balance}}</div>
                            <div class="in-box">
                                <input ng-keyup="enterMorgage($event)" type="text" readonly ng-model="balance">
                            </div>
                        </div>
                        <div class="item-box">
                            <div class="lable">{{doc.am}}</div>
                            <div class="in-box">
                                <input ng-blur="getLimit('mortgage',morgageAmount)" ng-keyup="enterMorgage($event)" type="text" ng-model="morgageAmount" placeholder="{{doc.am}}">
                            </div>
                        </div>
                        <div class="item-box" style="margin-left: 50px">
                            <div class="lable">Gas Limit</div>
                            <div class="in-box">
                                <input ng-keyup="enterMorgage($event)" type="text" ng-model="morgageLimit" placeholder=" Gas Limit">
                            </div>
                        </div>
                        <div class="item-box">
                            <div class="lable">Gas Price</div>
                            <div class="in-box">
                                <input ng-keyup="enterMorgage($event)" ng-keyup="enterEvent($event)" type="text" ng-model="morgagePrice" placeholder="Gas Price">
                            </div>
                        </div>

                        <div class="btn-dis" style="margin-top: 48px" ng-show="!morgagePass">{{doc.mortgage}}</div>
                        <div class="btn-unlock" style="margin-top: 48px" ng-click="Morgage()" ng-show="morgagePass">{{doc.mortgage}}</div>
                        <div style="margin-top:10px;font-family: PingFangSC-Regular;font-size: 14px;   color: rgba(102, 102, 102, 1);">
                            {{doc.callUs}}<br> {{doc.email}}
                        </div>
                    </div>
                    <div ng-show="action=='Unmortgage' && step == 2">
                        <div class="item-box">
                            <div class="lable">{{doc.votes}}</div>
                            <div class="in-box">
                                <input ng-keyup="enterUnmorgage($event)" ng-keyup="enterEvent($event)" type="text" readonly ng-model="vote">
                            </div>
                        </div>
                        <div class="item-box" style="margin-left: 50px">
                            <div class="lable">{{doc.balance}}</div>
                            <div class="in-box">
                                <input ng-keyup="enterUnmorgage($event)" ng-keyup="enterEvent($event)" type="text" readonly ng-model="balance">
                            </div>
                        </div>
                        <div class="item-box">
                            <div class="lable">{{doc.am}}</div>
                            <div class="in-box">
                                <input ng-blur="getLimit('unmortgage',unmorgageAmount)" ng-keyup="enterUnmorgage($event)" ng-keyup="enterEvent($event)" type="text" ng-model="unmorgageAmount" placeholder="{{doc.am}}">
                            </div>
                        </div>
                        <div class="item-box" style="margin-left: 50px">
                            <div class="lable">Gas Limit</div>
                            <div class="in-box">
                                <input ng-keyup="enterUnmorgage($event)" ng-keyup="enterEvent($event)" type="text" ng-model="unmorgageLimit" placeholder="Gas Limit">
                            </div>
                        </div>
                        <div class="item-box">
                            <div class="lable">Gas Price</div>
                            <div class="in-box">
                                <input ng-keyup="enterUnmorgage($event)" ng-keyup="enterEvent($event)" type="text" ng-model="unmorgagePrice" placeholder="Gas Price">
                            </div>
                        </div>
                        <div class="btn-dis" style="margin-top: 48px" ng-show="!unmorgagePass">{{doc.unmortgage}}</div>
                        <div class="btn-unlock" style="margin-top: 48px" ng-click="Unmorgage()" ng-show="unmorgagePass">{{doc.unmortgage}}</div>
                        <div style="margin-top:10px;font-family: PingFangSC-Regular;font-size: 14px;   color: rgba(102, 102, 102, 1);">
                            {{doc.callUs}}<br> {{doc.email}}
                        </div>
                    </div>
                    <div ng-show="action=='Referendum' && step == 2">
                        <div id="myApp">
                            <Tabs type="card">
                                <Tab-Pane :label="doc.proposal">
                                    <div class="tab1">
                                        <div class="item-box" style="margin-left: 50px">
                                            <div class="lable">{{doc.votes}}</div>
                                            <div class="in-box">
                                                <input id="rfdStake" ng-keyup="enterUnmorgage($event)" ng-keyup="enterEvent($event)" type="text" readonly ng-model="vote">
                                            </div>
                                        </div>

                                        <div class="item-box" style="margin-left: 50px">
                                            <div class="lable">{{doc.balance}}</div>
                                            <div class="in-box">
                                                <input ng-keyup="enterUnmorgage($event)" ng-keyup="enterEvent($event)" type="text" readonly ng-model="balance">
                                            </div>
                                        </div>

                                        <div class="item-box" style="margin-left: 50px">
                                            <div class="lable">{{doc.search}}</div>
                                            <div class="in-box">
                                                <input v-model="search">
                                            </div>
                                        </div>

                                        <divider></divider>
                                        <i-Select v-model="involved" style="width:200px;margin-left: 50px">
                                            <i-Option value="0">{{doc.all}}</i-Option>
                                            <i-Option value="1">{{doc.alreadyInvolved}}</i-Option>
                                            <i-Option value="2">{{doc.notInvolved}}</i-Option>
                                        </i-Select>
                                        <div style="text-align: center;height:80px;line-height: 150px" v-if="!showProposalRfdList.length">{{doc.noData}}</div>
                                        <div style="margin-left: 50px;width:1025px" v-for="r in showProposalRfdList.slice((this.pageNo1 - 1) * this.pageSize1, this.pageSize1 * this.pageNo1)">
                                            <p class="r-hash">hash: {{r.hash}}</p>
                                            <p class="r-title" :class="{thover:!!r.webUrl}" v-on:click.stop="toWebUrl(r,$event)">{{r.title}}</p>
                                            <div class="r-icon">
                                                <div style="float: left">
                                                    <Icon type="md-thumbs-up" color="#2CC868" size="20"></Icon>
                                                    <span style="color:#2CC868 ">{{doc.agree}}</span>
                                                    <span>{{r.Agree.stake}}INT（{{r.Agree.address?r.Agree.address.split(',').length:0}} {{doc.voters}}）</span>
                                                </div>
                                                <div style="float: right">
                                                    <Icon type="md-thumbs-down" color="#EE9221" size="20"></Icon>
                                                    <span style="color:#EE9221 ">{{doc.disagree}}</span>
                                                    <span>{{r.Disagree.stake}}INT（{{r.Disagree.address?r.Disagree.address.split(',').length:0}} {{doc.voters}}）</span>
                                                </div>
                                            </div>
                                            <div class="ivu-progress ivu-progress-normal" style="width: 100%;">
                                                <div class="ivu-progress-outer">
                                                    <div class="ivu-progress-inner">
                                                        <div v-bind:style="{width:getTotalWidth(r)}" class="ivu-progress-bg">
                                                            <span v-if="r.Agree.stake==0&&r.Disagree.stake==0" style="color:rgba(102, 102, 102, 1);margin-left: 10px ">0%</span>
                                                            <span v-if="r.Disagree.stake!=0" style="margin-right: 5px"> {{r.Disagree.stake=='0'||(r.Disagree.stake/(r.Agree.stake+r.Disagree.stake)*100).toFixed(0)=='0'?'':(r.Disagree.stake/(r.Agree.stake+r.Disagree.stake)*100).toFixed(0)+'%'}}
                                                            </span>
                                                        </div>
                                                        <div v-bind:style="{width:getAgreeWidth(r)}" class="ivu-progress-success-bg">
                                                            <span v-if="r.Agree.stake!=0" style="margin-left: 5px">
                                                                    {{r.Agree.stake=='0'||(r.Agree.stake/(r.Agree.stake+r.Disagree.stake)*100).toFixed(0)=='0'?'':(r.Agree.stake/(r.Agree.stake+r.Disagree.stake)*100).toFixed(0)+'%'}}
                                                            </span>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="margin-top:10px">
                                                <div class="r-time">
                                                    <span>{{doc.endTime}} {{moment(r.end).format("YYYY-MM-DD HH:mm:ss")}} (UTC+8)</span>
                                                </div>
                                                <div style="float: right">
                                                    <Radio-Group v-model="r.votedId" style="margin-right:50px">
                                                        <Radio :disabled="moment().valueOf()> moment(r.end).valueOf()" style="margin-right:20px" class="r-item" :label="r.Agree.optId">{{doc.agreee}}</Radio>
                                                        <Radio :disabled="moment().valueOf()> moment(r.end).valueOf()" class="r-item" :label="r.Disagree.optId">{{doc.disagree}}</Radio>
                                                    </Radio-Group>
                                                    <i-Button class="rfd_vote" type="primary" shape="circle" @click="rfdVote(r)" :disabled="r.votedId == ''|| moment().valueOf()> moment(r.end).valueOf()">{{doc.vote}}</i-Button>
                                                </div>
                                            </div>
                                            <div style="height:30px;width:10px"></div>
                                            <divider></divider>
                                        </div>
                                        <div style="float:right ;margin: 10px 50px 0 0;clear:both">
                                            <Page :total="showProposalRfdList.length" :page-size="pageSize1" @on-change="hanlePageNoChange1" />
                                        </div>
                                    </div>
                                </Tab-Pane>
                                <Tab-Pane :label="doc.oc">
                                    <div class="tab1">
                                        <div class="item-box" style="margin-left: 50px">
                                            <div class="lable">{{doc.votes}}</div>
                                            <div class="in-box">
                                                <input id="rfdStake" ng-keyup="enterUnmorgage($event)" ng-keyup="enterEvent($event)" type="text" readonly ng-model="vote">
                                            </div>
                                        </div>

                                        <div class="item-box" style="margin-left: 50px">
                                            <div class="lable">{{doc.balance}}</div>
                                            <div class="in-box">
                                                <input ng-keyup="enterUnmorgage($event)" ng-keyup="enterEvent($event)" type="text" readonly ng-model="balance">
                                            </div>
                                        </div>

                                        <div class="item-box" style="margin-left: 50px">
                                            <div class="lable">{{doc.search}}</div>
                                            <div class="in-box">
                                                <input v-model="search2">
                                            </div>
                                        </div>

                                        <divider></divider>
                                        <i-Select v-model="involved2" style="width:200px;margin-left: 50px">
                                            <i-Option value="0">{{doc.all}}</i-Option>
                                            <i-Option value="1">{{doc.alreadyInvolved}}</i-Option>
                                            <i-Option value="2">{{doc.notInvolved}}</i-Option>
                                        </i-Select>
                                        <div style="text-align: center;height:80px;line-height: 150px" v-if="!showRfd2.length">{{doc.noData}}</div>
                                        <div style="margin-left: 50px;width:1025px" v-for="r in showRfd2.slice((pageNo2 - 1) * pageSize2, pageSize2 * pageNo2)">
                                            <p class="r-hash">hash: {{r.hash}} <span style="float: right">{{doc.endTime}} {{moment(r.end).format("YYYY-MM-DD HH:mm:ss")}} (UTC+8)</span> </p>
                                            <p class="r-title" @click="isShowOpts(r)">{{r.title}} <a style="color: #2d8cf0" v-show="!!r.webUrl" v-on:click.stop="toWebUrl(r, 'viewAll',$event)" href="javascript:;">{{doc.viewAll}}</a> </p>
                                            <div class="options2" v-bind:class="{showOpts:!!r.showOpts}">
                                                <Checkbox-Group v-model="r.votedId">
                                                    <div v-for="opt in r.options" class="rfdoptions">
                                                        <Checkbox :disabled="moment().valueOf() > moment(r.end).valueOf()" :label="opt.optId"> <span class="r-item">{{opt.name}}</span> </Checkbox> <a style="color: #2d8cf0" v-show="!!opt.webUrl" v-on:click.stop="toWebUrl(opt,$event)" href="javascript:;">{{doc.view}}</a> <br/>
                                                    </div>
                                                </Checkbox-Group>
                                                <i-Button style="float: right;margin-top:20px;margin-right:50px" class="rfd_vote" type="primary" shape="circle" @click="rfdVote(r,'Checkbox')" :disabled="r.votedId.length==0|| moment().valueOf() > moment(r.end).valueOf()">{{doc.vote}}</i-Button>
                                            </div>
                                            <div style="height:15px;width:10px"></div>
                                            <divider></divider>
                                        </div>
                                        <div style="float:right ;margin: 10px 50px 0 0;clear:both">
                                            <Page :total="showRfd2.length" :page-size="pageSize2" @on-change="hanlePageNoChange2" />
                                        </div>
                                    </div>
                                </Tab-Pane>
                            </Tabs>
                        </div>
                    </div>
                </div>
            </div>
            <div class="foot">
                Copyright © 2018 INT
            </div>
        </div>

    </body>

    <script>
        let currentLan = new modal.UrlSearch().lan || 'en'

        let myVue = new Vue({
            el: '#myApp',
            data: {
                d: true,
                doc: lan[currentLan],
                search: "",
                involved: "0",
                search2: "",
                involved2: "0",
                ProposalRfdList: [],
                showProposalRfdList: [],
                rfd2: [],
                showRfd2: [],
                address: '',
                price: '',
                privateKey: '',
                moment,
                pageNo1: 1,
                pageSize1: 50,
                pageNo2: 1,
                pageSize2: 50,
                price: 0,
            },
            created() {
                this.queryProposalRfd();
                this.getRfd2();
            },
            methods: {
                toWebUrl(opt, str, e) {
                    if (str == 'viewAll') {
                        let arr = [];
                        for (let rfd of this.showRfd2) {
                            if (opt.id === rfd.id) {
                                rfd.showOpts = true
                            }
                            arr.push(rfd)
                        }
                        this.showRfd2 = [...arr]
                    }
                    if (!opt.webUrl) {
                        return;
                    }
                    if (opt.webUrl) {
                        window.open(opt.webUrl)
                    }
                    e.stopPropagation()
                },
                isShowOpts(r) {
                    let arr = [];
                    for (let rfd of this.showRfd2) {
                        if (r.id === rfd.id) {
                            rfd.showOpts = !rfd.showOpts
                        }
                        arr.push(rfd)
                    }
                    this.showRfd2 = [...arr]
                },
                rfdVote(r, type) {
                    let vm = this;
                    if (document.getElementById('rfdStake').value == 0) {
                        modal.error({
                            msg: this.doc.mf,
                            title: this.doc.notice,
                            okText: this.doc.confirm
                        })
                        return
                    }
                    let votedId;
                    if (type) {
                        votedId = [...r.votedId]
                    } else {
                        votedId = [r.votedId]
                    }
                    var wal = require("wal");
                    wal.rfdVote(this.price, this.privateKey, r.id, votedId).then(
                        function(res) {
                            if (res.err) {
                                modal.error({
                                    msg: res.err,
                                    title: vm.doc.notice,
                                    okText: vm.doc.confirm
                                })
                            } else {
                                modal.showInfo(res.info, vm.doc, function() {
                                    wal.sendSignedTransaction(res.renderStr).then(function(r) {
                                        if (typeof r === 'string') {
                                            r = JSON.parse(r)
                                        }
                                        if (r.err) {
                                            modal.error({
                                                msg: r.err,
                                                title: vm.doc.notice,
                                                okText: vm.doc.confirm
                                            })
                                        } else {
                                            // modal.success({ msg: r.hash })
                                            modal.burnSuccess({
                                                doc: vm.doc,
                                                msg: 'https://explorer.intchain.io/#/blockchain/txdetail?hash=' + r.hash
                                            })
                                        }
                                    })
                                })
                            }
                        }
                    )
                },
                hanlePageNoChange1(val) {
                    this.pageNo1 = val;
                },
                hanlePageNoChange2(val) {
                    this.pageNo2 = val;
                },
                queryProposalRfd() {
                    var wal = require("wal");
                    wal.queryProposalRfd().then(res => {
                        for (let r of res.data) {
                            r.votedId = '';
                            if (r.Disagree.address && r.Disagree.address.indexOf(this.address) > -1) {
                                r.votedId = r.Disagree.optId;
                            }
                            if (r.Agree.address && r.Agree.address.indexOf(this.address) > -1) {
                                r.votedId = r.Agree.optId;
                            }

                        }
                        this.ProposalRfdList = [...res.data];
                        this.showProposalRfdList = [...res.data];

                    })
                },
                getRfd2() {
                    var wal = require("wal");
                    wal.getRfd2().then(res => {
                        for (let r of res.data) {
                            r.votedId = [];
                            for (let o of r.options) {
                                if (o.address && o.address.indexOf(this.address) > -1) {
                                    r.votedId.push(o.optId);
                                }
                            }
                        }
                        this.rfd2 = [...res.data];
                        this.showRfd2 = [...res.data];

                    })
                },
                getTotalWidth(r) {

                    if (!r.Agree.stake && !r.Disagree.stake) {
                        return '0px';
                    }
                    let current = Date.now();
                    let begin = new Date(r.begin).getTime();
                    let end = new Date(r.end).getTime();
                    let result = (current - begin) / (end - begin) > 1 ? 1 : (current - begin) / (end - begin);

                    return result * 1025 + "px"

                },
                getAgreeWidth(r) {
                    if (!r.Agree.stake) {
                        return '0px';
                    }
                    let current = Date.now();
                    let begin = new Date(r.begin).getTime();
                    let end = new Date(r.end).getTime();
                    let result = (current - begin) / (end - begin) > 1 ? 1 : (current - begin) / (end - begin);
                    let agreeRate = r.Agree.stake / (r.Agree.stake + r.Disagree.stake);

                    return result * agreeRate * 1025 + "px"
                },


                changeLan(val) {
                    this.doc = lan[val];
                },
                show: function() {
                    this.visible = true;
                }
            },
            watch: {
                address(val) {
                    for (let r of this.ProposalRfdList) {
                        r.votedId = '';
                        if (r.Disagree.address && r.Disagree.address.indexOf(this.address) > -1) {
                            r.votedId = r.Disagree.optId;
                        }
                        if (r.Agree.address && r.Agree.address.indexOf(this.address) > -1) {
                            r.votedId = r.Agree.optId;
                        }

                    }
                    this.showProposalRfdList = [...this.ProposalRfdList];
                    for (let r of this.rfd2) {
                        r.votedId = [];
                        for (let o of r.options) {
                            if (o.address && o.address.indexOf(this.address) > -1) {
                                r.votedId.push(o.optId);
                            }
                        }

                    }
                    this.showRfd2 = [...this.rfd2];
                },
                search(val) {
                    let arr = [];
                    for (let r of this.ProposalRfdList) {
                        let flag = true
                        if (this.involved == "1") {
                            flag = !!r.votedId
                        }
                        if (this.involved == "2") {
                            flag = !r.votedId
                        }
                        if (r.title.indexOf(val) > -1 && flag) {
                            arr.push(r)
                        }
                    }
                    this.showProposalRfdList = [...arr]
                },
                involved(val) {
                    let arr = [];
                    for (let r of this.ProposalRfdList) {
                        let flag = true
                        if (val == "1") {
                            flag = !!r.votedId
                        }
                        if (val == "2") {
                            flag = !r.votedId
                        }
                        if (r.title.indexOf(this.search) > -1 && flag) {
                            arr.push(r)
                        }
                    }
                    //this.showProposalRfdList = [];
                    this.showProposalRfdList = [...arr]
                    console.log(this.showProposalRfdList)

                },
                search2(val) {
                    let arr = [];
                    for (let r of this.rfd2) {
                        let flag = true
                        if (this.involved == "1") {
                            flag = r.votedId.length > 0
                        }
                        if (this.involved == "2") {
                            flag = r.votedId.length == 0
                        }
                        if (r.title.indexOf(val) > -1 && flag) {
                            arr.push(r)
                        }
                    }
                    this.showRfd2 = [...arr]
                },
                involved2(val) {
                    let arr = [];
                    for (let r of this.rfd2) {
                        let flag = true
                        if (val == "1") {
                            flag = r.votedId.length > 0
                        }
                        if (val == "2") {
                            flag = r.votedId.length == 0
                        }
                        if (r.title.indexOf(this.search2) > -1 && flag) {
                            arr.push(r)
                        }
                    }
                    this.showRfd2 = [...arr]
                    console.log(this.showRfd2)
                }
            }
        })
    </script>
    <style>
        #myApp {
            margin-left: -135px;
            width: 1140px;
        }
        
        .ivu-tabs-bar {
            margin-bottom: 0px;
        }
        
        .tab1 {
            width: 100%;
            height: auto;
            border-left: 1px solid #dcdee2;
            border-right: 1px solid #dcdee2;
            border-bottom: 1px solid #dcdee2;
            padding-bottom: 70px;
        }
        
        input {
            margin-left: 24px;
            width: 85%;
            height: 98%;
            border: 0px;
            outline: none;
            -webkit-appearance: textfield;
            background-color: white;
            -webkit-rtl-ordering: logical;
            cursor: text;
            padding: 1px;
            text-rendering: auto;
            color: initial;
            letter-spacing: normal;
            word-spacing: normal;
            text-transform: none;
            text-indent: 0px;
            text-shadow: none;
            display: inline-block;
            text-align: start;
            font: 400 11px system-ui;
        }
        
        .r-hash {
            margin-top: 40px;
            color: rgba(102, 102, 102, 1);
            font-size: 14px;
            font-family: SourceHanSansCN-Normal;
        }
        
        .r-title {
            margin-top: 5px;
            color: rgba(51, 51, 51, 1);
            font-size: 18px;
            font-family: SourceHanSansCN-Medium;
            cursor: pointer;
        }
        
        .r-icon {
            height: auto;
            width: 100%;
            margin-top: 5px;
            color: rgba(102, 102, 102, 1);
            font-size: 18px;
            font-family: SourceHanSansCN-Medium;
        }
        
        .ivu-progress-bg {
            width: 90%;
            height: 16px;
            background-color: #EE9221;
            color: #FFFFFF;
            font-size: 14px;
            text-align: right;
            line-height: 16px;
        }
        
        .ivu-progress-success-bg {
            width: 30%;
            height: 16px;
            color: #FFFFFF;
            font-size: 14px;
            text-align: left;
            line-height: 16px;
        }
        
        .r-time {
            float: left;
            color: rgba(102, 102, 102, 1);
            font-size: 14px;
            font-family: SourceHanSansCN-Medium;
        }
        
        .r-item {
            color: rgba(51, 51, 51, 1);
            font-size: 14px;
            font-family: SourceHanSansCN-Normal;
            display: inline-block;
            vertical-align: top;
        }
        
        .ivu-radio-inner:after {
            background-color: #E56770;
        }
        
        .ivu-radio-checked .ivu-radio-inner {
            border-color: #E56770;
        }
        
        .ivu-radio-checked .ivu-radio-inner:hover {
            border-color: #E56770;
        }
        
        .ivu-btn-primary {
            background-color: #E56770;
            border-color: #E56770;
        }
        
        .ivu-btn-primary:hover {
            background-color: #E56770;
            border-color: #E56770;
        }
        
        li a .ivu-icon {
            margin-top: 8px;
        }
        
        .ivu-icon ::after:hover {
            margin-top: 5px;
        }
        
        .ivu-page-item-jump-next,
        .ivu-page-item-jump-prev {
            padding-top: 9px;
        }
        
        .ivu-page-item-jump-next:after,
        .ivu-page-item-jump-prev:after {
            margin-top: -9px;
        }
        
        .options2 {
            height: 0px;
            width: 100%;
            overflow: hidden;
            transition: height 1s;
            -webkit-transition: height 1s;
        }
        /* .options2:hover {
            height: 100px;
        } */
        
        .showOpts {
            height: auto;
        }
        
        .rfdoptions {
            margin-top: 10px;
            margin-left: 20px;
        }
        
        .ivu-checkbox-inner {
            display: inline-block;
            vertical-align: top
        }
        
        .ivu-checkbox-checked .ivu-checkbox-inner {
            border-color: #E56770;
            background-color: #E56770;
        }
        
        .ivu-checkbox-group {
            max-height: 400px;
            overflow-y: scroll;
        }
        
        a {
            color: rgba(102, 102, 102, 1);
        }
        
        .thover:hover {
            color: rgb(45, 140, 240);
        }
    </style>

</html>